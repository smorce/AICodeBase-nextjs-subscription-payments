async def run_parallel_research(self, research_state: dict):
        """ã‚µãƒ–ã‚°ãƒ©ãƒ•ã‚’ä¸¦åˆ—ã‹ã¤ç‹¬ç«‹ã—ã¦å‹•ã‹ã™"""
        # --------------------------------------------
        # ã‚µãƒ–ã‚°ãƒ©ãƒ•ã§å‹•ã‹ã™ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ3ã¤
        ##### ç ”ç©¶è€… (gpt-researcher) - ã‚µãƒ–ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦è©³ç´°ãªèª¿æŸ»ã‚’è¡Œã„ã€è‰ç¨¿ã‚’æ›¸ãã¾ã™ã€‚
        ##### ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“è€…           - follow_guidelines ã«åŸºã¥ã„ã¦ä¸‹æ›¸ãã®æ­£ç¢ºæ€§ã‚’æ¤œè¨¼ã—ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æä¾›ã—ã¾ã™ã€‚
        ##### æ ¡é–²è€…                  - ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“è€…ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ã„ã¦æº€è¶³ã®ã„ãå†…å®¹ã«ãªã‚‹ã¾ã§ä¸‹æ›¸ãã‚’ä¿®æ­£ã—ã¾ã™ã€‚
        # --------------------------------------------
        research_agent = ResearchAgent()
        reviewer_agent = ReviewerAgent()
        reviser_agent  = ReviserAgent()
        # --------------------------------------------
        queries = research_state.get("sections")           # ã‚µãƒ–ãƒˆãƒ”ãƒƒã‚¯(ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯)ã®ãƒªã‚¹ãƒˆã€‚ã¡ã‚ƒã‚“ã¨3ã¤ã«ãªã£ã¦ã„ãŸ
        title = research_state.get("title")                # ã“ã‚Œã¯åˆæœŸè¨ˆç”»åŠã³ãƒ¬ãƒãƒ¼ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ã«ãªã‚‹
        post_proxy = research_state.get("post_proxy")

        post_proxy.progress(f"ãƒ‡ãƒãƒƒã‚° ã‚µãƒ–ãƒˆãƒ”ãƒƒã‚¯(ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯)ã®ãƒªã‚¹ãƒˆ: {queries}\n")


        post_proxy.update_status("[doing]ResearchAgentğŸ” & ReviewerAgentğŸ“‘ & ReviserAgentğŸ“œ: å„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ä¸¦è¡Œã—ã¦ãƒªã‚µãƒ¼ãƒã™ã‚‹")


        """
        å¾Œã§æ¶ˆã™ã€‚researcher_with_print ãŒä½•æ•…ã‹3å›å‘¼ã³å‡ºã•ã‚Œã‚‹ã—ã€3å›ç›®ã¯reviewer_with_printãŒçµ‚ã‚ã£ãŸå¾Œã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚ãƒ©ãƒ³ã‚°ã‚°ãƒ©ãƒ•ã®è¬ä»•æ§˜ãªã®ã‹ã€ãƒã‚°ãªã®ã‹ï¼Ÿ

        # å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‡¦ç†ã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹é–¢æ•°ã‚’å®šç¾©
        async def researcher_with_print(state):
            post_proxy.update_status("[doing]ResearchAgentğŸ”: ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã‚’ä¸¦åˆ—ãƒªã‚µãƒ¼ãƒã™ã‚‹")
            result = await research_agent.run_depth_research(state)
            post_proxy.update_status("[done]ResearchAgentğŸ”: ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã‚’ä¸¦åˆ—ãƒªã‚µãƒ¼ãƒã™ã‚‹")
            return result

        async def reviewer_with_print(state):
            # task.json ã§ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒ False ãªã‚‰ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã¯ None ã«ãªã‚‹
            post_proxy.update_status("[doing]ReviewerAgentğŸ“‘: ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã™ã‚‹")
            result = reviewer_agent.run(state)   # åŒæœŸãƒ¡ã‚½ãƒƒãƒ‰ãªã®ã§ await ã—ãªã„
            post_proxy.update_status(f"[done]ReviewerAgentğŸ“‘: ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã™ã‚‹")
            return result

        async def reviser_with_print(state):
            # reviewer ã®çµæœãŒ None ãªã‚‰ æ ¡é–²è€… ã¯å‘¼ã³å‡ºã•ã‚Œãªã„
            post_proxy.update_status("[doing]ReviserAgentğŸ“œ: æ ¡æ­£ã™ã‚‹")
            result = reviser_agent.run(state)   # åŒæœŸãƒ¡ã‚½ãƒƒãƒ‰ãªã®ã§ await ã—ãªã„
            post_proxy.update_status("[done]ReviserAgentğŸ“œ: æ ¡æ­£ã™ã‚‹")
            return result
        """
       
       â˜…ã‚³ã‚³
        parent_step = cl.context.current_step
        print(f"ãƒ‡ãƒãƒƒã‚° parent_step ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ = {parent_step}")
        print(f"ãƒ‡ãƒãƒƒã‚° parent_step.id = {parent_step.id}")
        print(f"ãƒ‡ãƒãƒƒã‚° parent_step.name = {parent_step.name}")


       â˜…ã‚³ã‚³
        async with cl.Step(name="ResearchAgentğŸ” & ReviewerAgentğŸ“‘ & ReviserAgentğŸ“œ", parent_id=parent_step.id) as ThreeAgentStep:
            
            ThreeAgentStep.input = queries
            await ThreeAgentStep.stream_token('<span class="task-item pending">å„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ä¸¦è¡Œã—ã¦ãƒªã‚µãƒ¼ãƒã™ã‚‹</span>', True)

            # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®šç¾©
            workflow = StateGraph(DraftState)

            workflow.add_node("researcher", research_agent.run_depth_research)
            workflow.add_node("reviewer", reviewer_agent.run)
            workflow.add_node("reviser", reviser_agent.run)

            # set up edges researcher->reviewer->reviser->reviewer...
            workflow.set_entry_point("researcher")
            workflow.add_edge('researcher', 'reviewer')
            workflow.add_edge('reviser', 'reviewer')      # ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯
            # æ¡ä»¶ä»˜ãã‚¨ãƒƒã‚¸ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“è€…ã«ã‚ˆã‚‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¡ãƒ¢ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ã‚°ãƒ©ãƒ•ã¯ä¿®æ­£æ‹…å½“è€…ã«æŒ‡ç¤ºã•ã‚Œã¾ã™ã€‚ãã†ã§ãªã„å ´åˆã€ã‚µã‚¤ã‚¯ãƒ«ã¯æœ€çµ‚è‰æ¡ˆã§çµ‚äº†ã—ã¾ã™ã€‚
            workflow.add_conditional_edges('reviewer',
                                            (lambda draft: "accept" if draft['review'] is None else "revise"),
                                            {"accept": END, "revise": "reviser"})

            chain = workflow.compile()

            # Execute the graph for each query in parallel
            print_agent_output(f"Running the following research tasks in parallel: {queries}...", agent="EDITOR")
            # ainvoke ãªã®ã§è¤‡æ•°ã®ã‚¯ã‚¨ãƒªãƒ¼ã«å¯¾ã—ã¦éåŒæœŸã‹ã¤ä¸¦åˆ—ã§å®Ÿè¡Œã€‚å„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ä¸¦è¡Œã—ã¦å®Ÿè¡Œã™ã‚‹
            final_drafts = [chain.ainvoke({"task": research_state.get("task"), "topic": query, "title": title})
                            for query in queries]
            # asyncio.gather ãªã®ã§å…¨éƒ¨ã®ã‚¿ã‚¹ã‚¯ãŒçµ‚äº†ã™ã‚‹ã¾ã§æ¬¡ã«ã¯è¡Œã‹ãªã„
            research_results = [result['draft'] for result in await asyncio.gather(*final_drafts)]

            await ThreeAgentStep.stream_token('<span class="task-item completed">å„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ä¸¦è¡Œã—ã¦ãƒªã‚µãƒ¼ãƒã™ã‚‹</span>', True)



        # update_status ãŒä½¿ãˆãªã„ç†ç”±ã¯ä»¥ä¸‹
        # å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‡¦ç†ã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¦ã€ãã“ã§ post_proxy.update_status() ã—ã¦ã„ã‚‹ãŸã‚ã€self.prev_content ãŒã‚¬ãƒ³ã‚¬ãƒ³æ›´æ–°ã•ã‚Œã¦ã—ã¾ã„ã€ã€Œ[doing]ResearchAgent ~~~ ã—ã¦ãƒªã‚µãƒ¼ãƒã™ã‚‹ã€ ã¨ã¯é•ã†å†…å®¹ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‰
        # â†’ å¼·åˆ¶çš„ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†
        post_proxy.update_message(
                                "[doing]ResearchAgentğŸ” & ReviewerAgentğŸ“‘ & ReviserAgentğŸ“œ: å„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ä¸¦è¡Œã—ã¦ãƒªã‚µãƒ¼ãƒã™ã‚‹",
                                "[done]ResearchAgentğŸ” & ReviewerAgentğŸ“‘ & ReviserAgentğŸ“œ: å„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ä¸¦è¡Œã—ã¦ãƒªã‚µãƒ¼ãƒã™ã‚‹"
                                )

        # ãƒªã‚¿ãƒ¼ãƒ³ã™ã‚‹ã¨ãã«ã€ResearchState ã«å¯¾å¿œã™ã‚‹ Kye ã® Value ãŒæ›´æ–°ã•ã‚Œã‚‹
        return {"research_data": research_results, "post_proxy":post_proxy}